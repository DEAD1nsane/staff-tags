(()=>{var n=(o=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(o,{get:(i,c)=>(typeof require<"u"?require:i)[c]}):o)(function(o){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+o+'" is not supported')});var C=n("@vendetta/metro"),l=n("@vendetta/metro/common"),k=n("@vendetta/patcher"),g=n("@vendetta/plugin");var r=n("@vendetta/plugin"),v=n("@vendetta/storage"),R=n("@vendetta/ui/components"),y=n("@vendetta/ui/assets"),d=n("@vendetta/metro/common"),P=n("@vendetta/metro"),S=n("@vendetta/ui"),h=n("@vendetta/ui/toasts"),{ScrollView:A,View:T,Text:O,TouchableOpacity:B,TextInput:ie}=R.General,{FormLabel:w,FormArrow:le,FormRow:u,FormSwitch:ne,FormSwitchRow:Y,FormSection:b,FormDivider:I,FormInput:L}=R.Forms,x=(0,P.findByName)("Icon"),z=(0,P.findByName)("useIsFocused"),{BottomSheetFlatList:ce}=(0,P.findByProps)("BottomSheetScrollView"),M=(0,y.getAssetIDByName)("ic_add_24px"),$=(0,y.getAssetIDByName)("ic_arrow"),K=(0,y.getAssetIDByName)("ic_minus_circle_24px"),D=(0,y.getAssetIDByName)("Check"),_=(0,y.getAssetIDByName)("Small"),W=o=>`${o[0].toUpperCase()}${o.toLowerCase().slice(1)}`;var e=d.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:S.semanticColors.HEADER_SECONDARY,fontFamily:d.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3%",fontSize:24},sub:{color:S.semanticColors.TEXT_POSITIVE,fontFamily:d.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:S.semanticColors.HEADER_SECONDARY,fontFamily:d.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16}}),G="MissingNo",j=/[0-9A-Fa-f]{6}/,V=[{id:"useCustomTags",default:!1,label:"Use Custom Tags settings",subLabel:"Use Custom Tags Settings for this plugin."},{id:"useRoleColor",default:!1,label:"Use top role color",subLabel:"This may result in unreadable tags as it isn't possible to change the tag's text color."}];function F(){(0,v.useProxy)(r.storage);let{Permissions:o}=d.constants,c=Object.keys(o).sort(),m=d.NavigationNative.useNavigation();z(),r.storage.customTags??=[];let p=a=>{a<0&&(a=0),r.storage.customTags[a]||(r.storage.customTags[a]={name:"",color:"",perms:[]});let t=r.storage.customTags[a];m.push("VendettaCustomPage",{title:"Editing Custom Tag",render:()=>React.createElement(React.Fragment,null,React.createElement(A,null,React.createElement(b,{title:"Customize Tag",style:[e.header,e.basicPad]},React.createElement(T,{style:[e.basicPad,e.sub]},React.createElement(L,{title:"Display Tag Name",value:t?.name,placeholder:"Tag Name Here",onChange:s=>t.name=s}),React.createElement(L,{title:"Tag Color | HEX Code without Hashtag [#]",value:t?.color,placeholder:"HEX Code",onChange:s=>t.color=s}))),React.createElement(b,{title:"Tag Permissions",style:[e.header,e.basicPad]},React.createElement(T,{style:[e.basicPad,e.sub]},React.createElement(O,{style:[e.basicPad,e.flagsText]},`${t.perms.join(" | ")||"No Permissions Added."}`)),React.createElement(I,null),React.createElement(u,{label:"Set Permissions",subLabel:"Add what permissions to be used to mark user with this tag.",leading:React.createElement(u.Icon,{source:$}),onPress:()=>{m.push("VendettaCustomPage",{title:"Custom Tag Permissions",render:()=>React.createElement(React.Fragment,null,React.createElement(A,{style:{flex:1}},React.createElement(b,{title:"Permissions List",style:[e.header,e.basicPad]},React.createElement(T,{style:[e.basicPad,e.sub]},c?.map(s=>React.createElement(React.Fragment,null,React.createElement(u,{label:s,trailing:React.createElement(u.Icon,{source:t?.perms?.includes(s)?K:M}),onPress:()=>{t?.perms?.includes(s)?((0,h.showToast)(`${s} removed!`,_),t?.perms.splice(s,1)):((0,h.showToast)(`${s} added!`,D),t?.perms.push(s)),m.pop(),m.pop(),p(a)}})))))))})}})),React.createElement(u,{label:React.createElement(w,{text:"Save Custom Tag",style:{color:S.rawColors.GREEN_400}}),onPress:()=>{if(!t?.name?.length)return(0,h.showToast)("Tag Name Cannot be Empty",_);if(!t?.perms?.length)return(0,h.showToast)("Tag Permissions Cannot be Empty",_);if(!t.color.match(j))return(0,h.showToast)("Invalid HEX Code",_);a>-1?r.storage.customTags[a]=t:r.storage.customTags.push(t),(0,h.showToast)("Custom Tag Saved",D),m.pop(),m.pop(),f(!0)}}),React.createElement(u,{label:React.createElement(w,{text:"Delete Custom Tag",style:{color:S.rawColors.RED_400}}),onPress:()=>{r.storage.customTags.splice(a,1),m.pop(),m.pop(),f(!0)}})))})},f=a=>{m.push("VendettaCustomPage",{title:"List of Custom Tags",render:()=>React.createElement(React.Fragment,null,React.createElement(A,{style:{flex:1}},React.createElement(b,{title:"Tags List",style:[e.header,e.basicPad]},React.createElement(T,{style:[e.header,e.sub]},r.storage.customTags?.map((t,s)=>React.createElement(React.Fragment,null,React.createElement(u,{label:React.createElement(w,{text:t?.name}),onPress:()=>{let E=r.storage.customTags.findIndex(N=>N.name==t.name);p(E)}}),s!==r.storage.customTags?.length-1&&React.createElement(I,null))))),React.createElement(T,{style:[e.header,e.sub]},React.createElement(u,{label:"Add New Tags",trailing:React.createElement(B,{onPress:()=>{let t=r.storage?.customTags?.length;p(t)}},React.createElement(x,{source:M}))}))))})};return React.createElement(React.Fragment,null,React.createElement(A,{style:{flex:1}},React.createElement(b,{title:"Note",style:[e.header,e.basicPad]},React.createElement(O,{style:[e.basicPad,e.sub]},W("to enable custom tags, disable use default option and reload the plugin"))),React.createElement(b,{title:"Preferences",style:[e.header,e.basicPad]},React.createElement(T,{style:[e.basicPad,e.sub]},V.map((a,t)=>React.createElement(React.Fragment,null,React.createElement(Y,{label:a.label||G,subLabel:a.subLabel||G,value:r.storage[a.id]??a.default,onValueChange:s=>r.storage[a.id]=s}),t!==V?.length-1&&React.createElement(I,null))))),React.createElement(b,{title:"Customize",style:[e.header,e.basicPad]},React.createElement(T,{style:[e.basicPad,e.sub]},React.createElement(u,{label:"Custom Tags",onPress:f,trailing:React.createElement(B,{onPress:f},React.createElement(x,{source:M}))})))))}var U=n("@vendetta/ui"),q=(0,C.findByName)("RowManager"),J=(0,C.findByStoreName)("GuildStore"),Q=(0,C.findByStoreName)("ChannelStore"),{Permissions:Z}=l.constants,{computePermissions:ee}=(0,C.findByProps)("computePermissions","canEveryoneRole"),H,se=/[0-9A-Fa-f]{6}/,te=[l.i18n.Messages.AI_TAG,l.i18n.Messages.BOT_TAG_SERVER,l.i18n.Messages.SYSTEM_DM_TAG_SYSTEM,l.i18n.Messages.GUILD_AUTOMOD_USER_BADGE_TEXT],X=[{name:"WEBHOOK",condition:(o,i,c)=>c.isNonUserBot()},{name:"OWNER",color:U.rawColors.ORANGE_345,condition:(o,i,c)=>o?.ownerId===c.id||i?.type===3&&i?.ownerId===c.id},{name:l.i18n.Messages.BOT_TAG_BOT,condition:(o,i,c)=>c.bot}],oe=[...X,{name:"ADMIN",color:"7f1c1e",perms:["ADMINISTRATOR"]},{name:"MANAGER",color:"26b968",perms:["MANAGE_GUILD","MANAGE_CHANNELS","MANAGE_ROLES","MANAGE_WEBHOOKS"]},{text:"MOD",color:"00aafc",perms:["MANAGE_MESSAGES","KICK_MEMBERS","BAN_MEMBERS"]}],de={onLoad:()=>{g.storage.useCustomTags??=!1,g.storage.useRoleColor??=!1,g.storage.customTags??=[],H=(0,k.after)("generate",q.prototype,([o],{message:i})=>{if(o.rowType===1){if(!te.includes(i.tagText)){let{guildId:c,channelId:m}=i,p=J.getGuild(c),f=Q.getChannel(m),a,t;if(p){let s=ee({user:o.message.author,context:p,overwrites:f?.permissionOverwrites});a=Object.entries(Z).map(([E,N])=>s&N?E:"").filter(Boolean)}g.storage.useCustomTags?t=[...X,...g.storage.customTags]:t=oe;for(let s of t)if(s.condition?.(p,f,o.message.author)||s.perms?.some(E=>a?.includes(E))){i.tagText=s.name,s.color&&!(g.storage.useRoleColor&&o.message.colorString)&&(s.color.match(se)||(s.color="68b5d9"),s.color.startsWith("#")||(s.color=`#${s.color}`),i.tagBackgroundColor=l.ReactNative.processColor((0,l.chroma)(s.color).hex()));break}}g.storage.useRoleColor&&o.message.colorString&&i.tagText&&(i.tagBackgroundColor=l.ReactNative.processColor((0,l.chroma)(o.message.colorString).hex()))}})},onUnload:()=>H(),settings:F};})();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
